<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTTP server inside a docker container | YSMILES HOME</title><meta name=keywords content="Docker,Linux,Network,HTTP,Rust"><meta name=description content="Introduction This article mainly focus on how to run a HTTP server inside a docer container. The key point is port mapping.
Basic setup I skipped installation of docker at ubuntu here. Please refer to my last docker note.
For server example, I have some in my github.
C version
Python flask
Rust version
Here I choose Rust version for example.
Run Rust docker # pull rust official image to local docker pull rust # run a container docker run -itd -p 8080:5000 --name httpserver rust Here -itd means &lsquo;interactive&rsquo;, &lsquo;TTY&rsquo; and &lsquo;detached&rsquo;, which are running options of container."><meta name=author content="Frederick"><link rel=canonical href=/posts/http-server-inside-a-docker-container/><link crossorigin=anonymous href=/assets/css/stylesheet.ddbf7219471e1126282438a902837d962a32b41ca0eb0fdcbea41bcd83b8d308.css integrity="sha256-3b9yGUceESYoJDipAoN9lioytByg6w/cvqQbzYO40wg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=/images/yun-da.png><link rel=mask-icon href=/images/yun-da.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTTP server inside a docker container"><meta property="og:description" content="Introduction This article mainly focus on how to run a HTTP server inside a docer container. The key point is port mapping.
Basic setup I skipped installation of docker at ubuntu here. Please refer to my last docker note.
For server example, I have some in my github.
C version
Python flask
Rust version
Here I choose Rust version for example.
Run Rust docker # pull rust official image to local docker pull rust # run a container docker run -itd -p 8080:5000 --name httpserver rust Here -itd means &lsquo;interactive&rsquo;, &lsquo;TTY&rsquo; and &lsquo;detached&rsquo;, which are running options of container."><meta property="og:type" content="article"><meta property="og:url" content="/posts/http-server-inside-a-docker-container/"><meta property="og:image" content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-12-06T00:00:00+00:00"><meta property="article:modified_time" content="2017-12-06T00:00:00+00:00"><meta property="og:site_name" content="ysmiles homepage"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTTP server inside a docker container"><meta name=twitter:description content="Introduction This article mainly focus on how to run a HTTP server inside a docer container. The key point is port mapping.
Basic setup I skipped installation of docker at ubuntu here. Please refer to my last docker note.
For server example, I have some in my github.
C version
Python flask
Rust version
Here I choose Rust version for example.
Run Rust docker # pull rust official image to local docker pull rust # run a container docker run -itd -p 8080:5000 --name httpserver rust Here -itd means &lsquo;interactive&rsquo;, &lsquo;TTY&rsquo; and &lsquo;detached&rsquo;, which are running options of container."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"/posts/"},{"@type":"ListItem","position":3,"name":"HTTP server inside a docker container","item":"/posts/http-server-inside-a-docker-container/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTTP server inside a docker container","name":"HTTP server inside a docker container","description":"Introduction This article mainly focus on how to run a HTTP server inside a docer container. The key point is port mapping.\nBasic setup I skipped installation of docker at ubuntu here. Please refer to my last docker note.\nFor server example, I have some in my github.\nC version\nPython flask\nRust version\nHere I choose Rust version for example.\nRun Rust docker # pull rust official image to local docker pull rust # run a container docker run -itd -p 8080:5000 --name httpserver rust Here -itd means \u0026lsquo;interactive\u0026rsquo;, \u0026lsquo;TTY\u0026rsquo; and \u0026lsquo;detached\u0026rsquo;, which are running options of container.","keywords":["Docker","Linux","Network","HTTP","Rust"],"articleBody":"Introduction This article mainly focus on how to run a HTTP server inside a docer container. The key point is port mapping.\nBasic setup I skipped installation of docker at ubuntu here. Please refer to my last docker note.\nFor server example, I have some in my github.\nC version\nPython flask\nRust version\nHere I choose Rust version for example.\nRun Rust docker # pull rust official image to local docker pull rust # run a container docker run -itd -p 8080:5000 --name httpserver rust Here -itd means ‘interactive’, ‘TTY’ and ‘detached’, which are running options of container. -p set the port mapping. 8080 is our server port, 5000 is the container port.\nSo we need set the server in side container to listen http request at port 5000.\nBecause we run the container in detached mode, first we need attach to the container (go into it).\n# httpserver is our container name docker attach httpserver Inside container we can use ctrl-p then ctrl-q to detach again.\nAnother way to go into the container is open another bash.\n# -it has same meaning as 'docker run' docker exec -it httpserver bash Since we have one more bash now, it’s OK to close one bash.\nSetup server Now assume we are already in the container. Vim and Git might be needed. But I skip their installation here.\nTo fetch and run the server:\n# clone source code from my github git clone https://github.com/ysmiles/ServerClientExamples-Rust # compile and run cd tcptime/ cargo run It might be necessary to change line 11 for main.rs at src folder from ‘TcpListener::bind(“127.0.0.1:8000”)’ to ‘TcpListener::bind(“0.0.0.0:5000”)’ before compiling. Because we want this server works from ‘outside’ view, and before we mapped some port to container port 5000.\nNow detach from the container and test at server local to see the result.\n# curl can give a http request to a specific address curl http://0.0.0.0:8080 The output should be something like below:\n\u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"utf-8\"\u003e \u003ctitle\u003eHello!\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003ch1\u003eHello!\u003c/h1\u003e \u003cp\u003eHi from Rust\u003c/p\u003e \u003cp\u003eCurrent server time is:\u003c/p\u003e \u003cp\u003e2017-12-06 11:20:17\u003c/p\u003e \u003c/body\u003e \u003c/html\u003e Then test remotely. Here is my page, you can test it. This http serve will return the server machine local time.\nhttp://138.68.5.16:8080/\n","wordCount":"367","inLanguage":"en","datePublished":"2017-12-06T00:00:00Z","dateModified":"2017-12-06T00:00:00Z","author":{"@type":"Person","name":"Frederick"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/http-server-inside-a-docker-container/"},"publisher":{"@type":"Organization","name":"YSMILES HOME","logo":{"@type":"ImageObject","url":"/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="ysmiles (Alt + H)"><img src=/images/yun-da.png alt aria-label=logo height=35>ysmiles</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/about title="About me"><span>About me</span></a></li><li><a href=/tags title=Tags><span>Tags</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href>Home</a>&nbsp;»&nbsp;<a href=/posts/>Posts</a></div><h1 class=post-title>HTTP server inside a docker container</h1><div class=post-meta><span title='2017-12-06 00:00:00 +0000 UTC'>December 6, 2017</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Frederick</div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>This article mainly focus on how to run a HTTP server inside a docer container.
The key point is port mapping.</p><h2 id=basic-setup>Basic setup<a hidden class=anchor aria-hidden=true href=#basic-setup>#</a></h2><p>I skipped installation of docker at ubuntu here. Please refer to my <a href=http://ysmiles.com/2017/10/05/Run-a-basic-gRPC-example-with-Docker/>last docker note</a>.</p><p>For server example, I have some in my github.</p><p><a href=https://github.com/ysmiles/ServerClientExamples>C version</a></p><p><a href=https://github.com/ysmiles/Smart_Intersection>Python flask</a></p><p><a href=https://github.com/ysmiles/ServerClientExamples-Rust>Rust version</a></p><p>Here I choose Rust version for example.</p><h2 id=run-rust-docker>Run Rust docker<a hidden class=anchor aria-hidden=true href=#run-rust-docker>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># pull rust official image to local</span>
</span></span><span style=display:flex><span>docker pull rust
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># run a container</span>
</span></span><span style=display:flex><span>docker run -itd -p 8080:5000 --name httpserver rust
</span></span></code></pre></div><p>Here <code>-itd</code> means &lsquo;interactive&rsquo;, &lsquo;TTY&rsquo; and &lsquo;detached&rsquo;, which are running options of container.
<code>-p</code> set the port mapping. 8080 is our server port, 5000 is the container port.</p><p>So we need set the server in side container to listen http request at port 5000.</p><p>Because we run the container in detached mode, first we need attach to the container (go into it).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># httpserver is our container name</span>
</span></span><span style=display:flex><span>docker attach httpserver
</span></span></code></pre></div><p>Inside container we can use <code>ctrl-p</code> then <code>ctrl-q</code> to detach again.</p><p>Another way to go into the container is open another bash.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># -it has same meaning as &#39;docker run&#39;</span>
</span></span><span style=display:flex><span>docker exec -it httpserver bash
</span></span></code></pre></div><p>Since we have one more bash now, it&rsquo;s OK to close one bash.</p><h2 id=setup-server>Setup server<a hidden class=anchor aria-hidden=true href=#setup-server>#</a></h2><p>Now assume we are already in the container. Vim and Git might be needed. But I skip their installation here.</p><p>To fetch and run the server:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># clone source code from my github</span>
</span></span><span style=display:flex><span>git clone https://github.com/ysmiles/ServerClientExamples-Rust
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># compile and run</span>
</span></span><span style=display:flex><span>cd tcptime/
</span></span><span style=display:flex><span>cargo run
</span></span></code></pre></div><p>It might be necessary to change line 11 for <code>main.rs</code> at <code>src</code> folder from &lsquo;TcpListener::bind(&ldquo;127.0.0.1:8000&rdquo;)&rsquo; to &lsquo;TcpListener::bind(&ldquo;0.0.0.0:5000&rdquo;)&rsquo; before compiling.
Because we want this server works from &lsquo;outside&rsquo; view, and before we mapped some port to container port 5000.</p><p>Now detach from the container and test at server local to see the result.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># curl can give a http request to a specific address</span>
</span></span><span style=display:flex><span>curl http://0.0.0.0:8080
</span></span></code></pre></div><p>The output should be something like below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>title</span>&gt;Hello!&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>h1</span>&gt;Hello!&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>p</span>&gt;Hi from Rust&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>p</span>&gt;Current server time is:&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>p</span>&gt;2017-12-06 11:20:17&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><p>Then test remotely. Here is my page, you can test it. This http serve will return the server machine local time.</p><p>http://138.68.5.16:8080/</p></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/docker/>Docker</a></li><li><a href=/tags/linux/>Linux</a></li><li><a href=/tags/network/>Network</a></li><li><a href=/tags/http/>HTTP</a></li><li><a href=/tags/rust/>Rust</a></li></ul><nav class=paginav><a class=prev href=/posts/differences-between-an-interface-and-abstract-class/><span class=title>« Prev</span><br><span>Differences between an interface and abstract class</span></a>
<a class=next href=/posts/bitcoin-price-prediction/><span class=title>Next »</span><br><span>Bitcoin price prediction</span></a></nav></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//ysmiles.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a><nav id=TableOfContents><h2></h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#basic-setup>Basic setup</a></li><li><a href=#run-rust-docker>Run Rust docker</a></li><li><a href=#setup-server>Setup server</a></li></ul></nav></nav></article></main><footer class=footer><span>&copy; 2023 <a href>YSMILES HOME</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>